#define myubbr (16000000L/16/250000-1)
#define pin_RED 11
#define pin_GREEN 5
#define pin_BLUE 6
volatile unsigned char DMX[64];
volatile int DMXChannel=0;

ISR(USART_RX_vect)
{
  char temp,temp1;
  temp1 = UCSR0A;
  temp = UDR0&0xFF;
  if ((temp1 & (1<<FE0))||temp1 & (1<<DOR0)) //Break
  {
    DMXChannel = 0;
    return;
  }
  else if (DMXChannel<(char)25)
  {
    DMX[DMXChannel++]=temp&0xFF;
  }
}

void setup()
{
  pinMode(0,INPUT); //DMX Serial IN
  pinMode(pin_BLUE,OUTPUT); //BLUE
  pinMode(pin_GREEN,OUTPUT); //GREEN
  pinMode(pin_RED,OUTPUT); //RED
  delay(100);
  UBRR0H = (unsigned char)(myubbr>>8);
  UBRR0L = (unsigned char)myubbr;
  UCSR0B |= ((1<<RXEN0)|(1<<RXCIE0));//Enable Receiver and Interrupt RX
  UCSR0C |= (3<<UCSZ00);//N81
 
}
void loop()
{
    analogWrite(pin_RED,255-DMX[1]);
    analogWrite(pin_GREEN,255-DMX[2]);
    analogWrite(pin_BLUE,255-DMX[3]);
}
